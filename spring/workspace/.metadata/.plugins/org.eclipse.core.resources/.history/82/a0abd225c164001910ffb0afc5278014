package com.itwill.cafe;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.Toolkit;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.IOException;

import javax.swing.BoxLayout;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JSplitPane;
import javax.swing.table.DefaultTableModel;

import org.eclipse.wb.swing.FocusTraversalOnArray;

// Pos프로그램에 관한 화면구성 관련 클래스 입니다.
public class PosJFrame extends JFrame {

	private static final long serialVersionUID = 1L;
	private JPanel contentPane;
	private PosJFrameEventListener eventListener = new PosJFrameEventListener();

	final int ItemSize = 12;

	PaymentJTableJPanel paymentJTableJPanel;

	JButton btnCaffe = null;
	JButton btnBaverage;
	JButton btnDesert;
	JButton btnBagel;

	PaymentJDialog jDialog;
	AdminJDialog adminJDialog;

	CentralGradientButton[] btnItemButtons = new CentralGradientButton[ItemSize];

	JButton btnPayment;
	JButton btnBefore;
	JButton btnNext;
	JButton btnAdmin;
	JButton btnDiscount;
	JButton btnOrder;
	JButton btnCusomer;
	JLabel lblNewLabel;

	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					PosJFrame frame = new PosJFrame("Pos");
					frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();

				}
			}
		});
	}

	public void invalidData(boolean isScrollInvalied) {

		DefaultTableModel model = (DefaultTableModel) paymentJTableJPanel.table.getModel();

		long result = 0;
		for (int i = 0; i < model.getRowCount(); i++) {

			String strPrice = model.getValueAt(i, 4).toString();
			String strDigit = ((String) strPrice).replaceAll("[^0-9]", "");
			int Price = Integer.parseInt(strDigit);
			result += Price;
		}

		lblNewLabel.setText("총 결재 금액:" + StringUtil.getInstance().getPriceDecimalFormat((int) result) + "원");

		if (isScrollInvalied)
			paymentJTableJPanel.jScrollPane.getVerticalScrollBar()
					.setValue(paymentJTableJPanel.jScrollPane.getMaximumSize().height);
	}

	public PosJFrame(String title) throws IOException {
		super(title);
		eventListener.setJFrame(this);

		Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
		double width = screenSize.getWidth();
		double height = screenSize.getHeight();

		setResizable(false);
		WindowsInfo.setWindowsSize((int) width, (int) height);

		// 결재 다이얼 로그
		jDialog = new PaymentJDialog(this, true);

		// 관리자 다이얼 로그
		adminJDialog = new AdminJDialog(this, true);

		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(0, 0, WindowsInfo.getIntance().WINDOWS_WIDTH, WindowsInfo.getIntance().WINDOWS_HEIGHT);

		contentPane = new JPanel();
		setContentPane(contentPane);
		contentPane.setLayout(new BorderLayout(0, 0));

		JPanel imgPanel = new BackgroundJPanel(new ImageIcon("images/background.png").getImage());
		imgPanel.setBackground(Color.ORANGE);

		contentPane.add(imgPanel);
		imgPanel.setLayout(new BorderLayout(0, 0));

		JSplitPane splitPane = new JSplitPane();
		splitPane.setBackground(new Color(0, 0, 0, 0));
		imgPanel.add(splitPane, BorderLayout.CENTER);

		splitPane.addPropertyChangeListener(JSplitPane.DIVIDER_LOCATION_PROPERTY, new PropertyChangeListener() {
			@Override
			public void propertyChange(PropertyChangeEvent pce) {
				repaint();

			}

		});

		JPanel panel_1 = new JPanel();
		panel_1.setBackground(new Color(0, 0, 0, 0));
		splitPane.setLeftComponent(panel_1);
		panel_1.setLayout(new BoxLayout(panel_1, BoxLayout.Y_AXIS));

		JPanel panel_3 = new JPanel();
		panel_3.setPreferredSize(new Dimension(1000, 800));
		FlowLayout flowLayout = (FlowLayout) panel_3.getLayout();
		flowLayout.setVgap(30);
		flowLayout.setHgap(20);
		panel_3.setBackground(Color.WHITE);
		panel_3.setBackground(new Color(0, 0, 0, 0));
		panel_1.add(panel_3);

		Runnable r = (Runnable) imgPanel;
		Thread thread = new Thread(r);
		thread.start();

		paymentJTableJPanel = new PaymentJTableJPanel(this);
		JPanel panel_9 = paymentJTableJPanel;
		panel_9.setPreferredSize(new Dimension(800, 600));
		panel_3.add(panel_9);

		JPanel panel_4 = new JPanel();
		panel_4.setBackground(Color.LIGHT_GRAY);
		panel_1.add(panel_4);

		panel_4.setLayout(new FlowLayout(FlowLayout.CENTER, 5, 5));

		lblNewLabel = new JLabel("\uCD1D \uACB0\uC81C \uAE08\uC561:");
		lblNewLabel.setFont(new Font("Serif", Font.PLAIN, 30));
		lblNewLabel.setPreferredSize(new Dimension(500, 100));
		panel_4.add(lblNewLabel);

		panel_4.setFocusTraversalPolicy(new FocusTraversalOnArray(new Component[] { lblNewLabel, btnPayment }));

		JPanel panel_2 = new JPanel();
		splitPane.setRightComponent(panel_2);
		panel_2.setLayout(new BoxLayout(panel_2, BoxLayout.Y_AXIS));

		JSplitPane splitPane_1 = new JSplitPane();
		splitPane_1.setBackground(new Color(0, 0, 0, 0));

		splitPane_1.addPropertyChangeListener(JSplitPane.DIVIDER_LOCATION_PROPERTY, new PropertyChangeListener() {
			@Override
			public void propertyChange(PropertyChangeEvent pce) {
				repaint();
			}
		});

		splitPane_1.setOrientation(JSplitPane.VERTICAL_SPLIT);
		panel_2.add(splitPane_1);

		JPanel panel_5 = new JPanel();
		splitPane_1.setLeftComponent(panel_5);
		panel_5.setBackground(new Color(0, 0, 0, 0));
		JPanel panel_7 = new JPanel();
		panel_7.setBackground(Color.WHITE);

		panel_7.setPreferredSize(new Dimension(600, 400));
		panel_5.add(panel_7);
		panel_7.setLayout(new GridLayout(4, 4, 0, 0));

		JPanel panel_6 = new JPanel();
		splitPane_1.setRightComponent(panel_6);
		panel_6.setBackground(new Color(0, 0, 0, 0));

		JPanel panel_8 = new JPanel();
		panel_8.setPreferredSize(new Dimension(600, 100));
		panel_6.add(panel_8);
		panel_8.setLayout(new GridLayout(0, 4, 0, 0));

		JPanel panel = new JPanel();
		imgPanel.add(panel, BorderLayout.SOUTH);
		panel.setLayout(new GridLayout(0, 4, 0, 0));

		btnPayment = new CentralGradientButton("\uACB0\uC7AC");
		btnPayment.addActionListener(eventListener);

		btnPayment.setPreferredSize(new Dimension(120, 100));
		panel_4.add(btnPayment);

		for (int i = 0; i < ItemSize; i++) {
			btnItemButtons[i] = new CentralGradientButton("");
			btnItemButtons[i].setEnabled(false);
			panel_7.add(btnItemButtons[i]);
			btnItemButtons[i].addActionListener(eventListener);
		}

		btnBefore = new CentralGradientButton("<<");
		btnBefore.setEnabled(false);
		panel_7.add(btnBefore);
		btnBefore.addActionListener(eventListener);

		btnNext = new CentralGradientButton(">>");
		btnNext.setEnabled(false);
		panel_7.add(btnNext);
		btnNext.addActionListener(eventListener);

		btnCaffe = new CentralGradientButton("커피");
		panel_8.add(btnCaffe);
		btnCaffe.addActionListener(eventListener);
		btnCaffe.repaint();
		btnBaverage = new CentralGradientButton("차");
		panel_8.add(btnBaverage);
		btnBaverage.addActionListener(eventListener);

		btnDesert = new CentralGradientButton("디저트");
		panel_8.add(btnDesert);
		btnDesert.addActionListener(eventListener);

		btnBagel = new CentralGradientButton("베이글");
		panel_8.add(btnBagel);
		btnBagel.addActionListener(eventListener);

		btnAdmin = new CentralGradientButton("매출 관리자");
		btnAdmin.setPreferredSize(new Dimension(100, 100));
		panel.add(btnAdmin);
		btnAdmin.addActionListener(eventListener);

		btnDiscount = new CentralGradientButton("할인");
		panel.add(btnDiscount);
		btnDiscount.addActionListener(eventListener);
		btnDiscount.setEnabled(false);

		btnOrder = new CentralGradientButton("주문 관리");
		panel.add(btnOrder);
		btnOrder.addActionListener(eventListener);
		btnOrder.setEnabled(false);

		btnCusomer = new CentralGradientButton("고객 요청 사항");
		panel.add(btnCusomer);
		btnCusomer.addActionListener(eventListener);
		btnCusomer.setEnabled(false);

	}
}
